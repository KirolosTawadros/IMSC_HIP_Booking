# ميزة إلغاء الحجز - Cancel Booking Feature

## نظرة عامة
تم إضافة ميزة إلغاء الحجز للتطبيق، مما يسمح للأطباء بإلغاء حجوزاتهم القادمة واستعادة السعة المتاحة.

## الميزات المضافة

### 1. Backend API
- **Endpoint:** `DELETE /api/bookings/:bookingId`
- **الوظيفة:** إلغاء حجز محدد
- **التحققات:**
  - التأكد من وجود الحجز
  - التأكد من أن الحجز في المستقبل
  - التأكد من أن الميعاد لم يبدأ بعد (للحجوزات في نفس اليوم)
- **الاستجابة:** رسالة نجاح + إشعار للمستخدم

### 2. Frontend (Mobile App)
- **شاشة حجوزاتي:** إضافة زر "إلغاء الحجز" للحجوزات القابلة للإلغاء
- **التحققات:** عرض الزر فقط للحجوزات المستقبلية
- **تأكيد الإلغاء:** نافذة تأكيد قبل الإلغاء
- **معالجة الأخطاء:** رسائل خطأ واضحة للمستخدم

### 3. الترجمات
تم إضافة الترجمات التالية:
- `cancel_booking`: "إلغاء الحجز"
- `cancel_booking_confirm`: "هل أنت متأكد من إلغاء هذا الحجز؟"
- `cancel_booking_success`: "تم إلغاء الحجز بنجاح"
- `cancel_booking_error`: "فشل في إلغاء الحجز"
- `cannot_cancel_past`: "لا يمكن إلغاء الحجوزات السابقة"
- `cannot_cancel_started`: "لا يمكن إلغاء الحجوزات التي بدأت بالفعل"

## كيفية العمل

### شروط إلغاء الحجز:
1. **الحجز في المستقبل:** لا يمكن إلغاء الحجوزات السابقة
2. **الميعاد لم يبدأ:** لا يمكن إلغاء الحجوزات التي بدأت بالفعل في نفس اليوم
3. **الحجز موجود:** يجب أن يكون الحجز موجود في قاعدة البيانات

### عملية الإلغاء:
1. المستخدم يضغط على زر "إلغاء الحجز"
2. يظهر تأكيد الإلغاء
3. عند التأكيد، يتم إرسال طلب DELETE للـ API
4. يتم حذف الحجز من قاعدة البيانات
5. يتم إنشاء إشعار للمستخدم
6. يتم تحديث قائمة الحجوزات

## الملفات المعدلة

### Backend:
- `backend/routes/bookings.js` - إضافة endpoint إلغاء الحجز

### Frontend:
- `mobile/services/api.js` - إضافة API function
- `mobile/app/screens/MyBookingsScreen.tsx` - إضافة واجهة الإلغاء
- `mobile/app/screens/HomeScreen.tsx` - تحديث الترجمات
- `mobile/assets/locales/ar.json` - إضافة الترجمات العربية
- `mobile/assets/locales/en.json` - إضافة الترجمات الإنجليزية

## اختبار الميزة

### اختبار إلغاء حجز مستقبلي:
1. إنشاء حجز لموعد في المستقبل
2. الذهاب لشاشة "حجوزاتي"
3. الضغط على زر "إلغاء الحجز"
4. تأكيد الإلغاء
5. التحقق من اختفاء الحجز من القائمة

### اختبار إلغاء حجز سابق (يجب أن يفشل):
1. محاولة إلغاء حجز لموعد سابق
2. يجب أن تظهر رسالة خطأ "لا يمكن إلغاء الحجوزات السابقة"

### اختبار إلغاء حجز اليوم بعد بدء الميعاد (يجب أن يفشل):
1. محاولة إلغاء حجز لموعد اليوم بعد بدء الميعاد
2. يجب أن تظهر رسالة خطأ "لا يمكن إلغاء الحجوزات التي بدأت بالفعل"

## ملاحظات تقنية

### الأمان:
- التحقق من صحة البيانات قبل الإلغاء
- معالجة الأخطاء بشكل مناسب
- إنشاء إشعارات للمستخدم

### الأداء:
- تحديث فوري لقائمة الحجوزات
- معالجة حالة التحميل أثناء الإلغاء
- عدم إعادة تحميل البيانات غير الضرورية

### تجربة المستخدم:
- رسائل واضحة ومفهومة
- تأكيد الإلغاء لتجنب الأخطاء
- تغذية راجعة فورية للمستخدم 